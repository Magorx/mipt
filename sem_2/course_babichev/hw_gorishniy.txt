№1
Заметим, что требуемая ассимптотика очень на Форда-Беллмана, запущенного в бинпоиске. Так и быть - организуем бинпоиск по наличию отрицательного цикла в графе, в ребрах которого мы вычитаем middle * eps, middle = (left + right) / 2 (делать это, кстати, можно виртуально, т.е. и правда бесплатно ко времени). В момент, когда l и r сойдутся, мы получим некоторое значение mid, при котором в графе существует единственный отрицательный цикл - на нем и будет лежать цикл минимальной средней длины! Если же откроется несколько таких циклов, значит, для них значение этого среднего совпадает. Ассимптотика - O(n*m*C*log(1/eps)).
